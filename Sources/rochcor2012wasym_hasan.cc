#include <rochcor2012wasym_hasan.h>
#include <TLorentzVector.h>


const float rochcor2012::netabin[25] = {-2.4,-2.25,-2.1,-1.85,-1.6,-1.4,-1.2,-1.0,-0.8,-0.6,-0.4,-0.2,
					0.0,0.2,0.4,0.6,0.8,1.0,1.2,1.4,1.6,1.85,2.1,2.25,2.4};

const float rochcor2012::dcor_bf[16][24]={{0.000060495,-0.000018229,-0.000017735,-0.000012864,0.000043847,0.000063053,0.000088843,0.000072458,0.000070597,0.000091578,0.000108018,0.000090720,0.000102611,0.000093808,0.000082857,0.000082794,0.000089761,0.000052970,0.000071236,0.000030983,0.000017112,0.000034020,-0.000020335,-0.000045376},
					  {-0.000026979,0.000021585,0.000020540,0.000018898,0.000065008,0.000058834,0.000055552,0.000078619,0.000076985,0.000094768,0.000104184,0.000098008,0.000088825,0.000108412,0.000087676,0.000056410,0.000079462,0.000058615,0.000056003,0.000058558,0.000036970,0.000021419,0.000050018,0.000023284},
					  {0.000017995,0.000040599,0.000044464,0.000026810,0.000040488,0.000052918,0.000056723,0.000091896,0.000087059,0.000100627,0.000091927,0.000086045,0.000093846,0.000085326,0.000059339,0.000069946,0.000064847,0.000054533,0.000030821,0.000039986,0.000033132,0.000060004,0.000008686,0.000030108},
					  {0.000029218,0.000017812,0.000032332,0.000036926,0.000058793,0.000059862,0.000083472,0.000084910,0.000110772,0.000098409,0.000089170,0.000098931,0.000114366,0.000085073,0.000096699,0.000088823,0.000084208,0.000082991,0.000067377,0.000051364,0.000041869,0.000028800,0.000060898,0.000030253},
					  {0.000070498,0.000019721,0.000038784,0.000048432,0.000042643,0.000082585,0.000067161,0.000077301,0.000076726,0.000074605,0.000093412,0.000078531,0.000095107,0.000080444,0.000079278,0.000077392,0.000074164,0.000071558,0.000050712,0.000037934,0.000036342,0.000018647,0.000048342,-0.000007048},
					  {0.000003259,0.000026181,0.000022581,0.000042844,0.000047723,0.000054820,0.000080713,0.000087025,0.000090625,0.000076073,0.000098316,0.000075101,0.000108318,0.000093981,0.000073400,0.000079746,0.000050034,0.000068167,0.000056412,0.000041834,0.000051137,0.000032807,0.000009086,0.000073571},
					  {0.000007889,-0.000030137,0.000007229,0.000032626,0.000033917,0.000045918,0.000059830,0.000086615,0.000059242,0.000073331,0.000085617,0.000097019,0.000091705,0.000087558,0.000086657,0.000051638,0.000066965,0.000031858,0.000059129,0.000041906,0.000023696,0.000009872,0.000008049,-0.000072057},
					  {0.000039440,-0.000005357,0.000022828,0.000075193,0.000043021,0.000041896,0.000051031,0.000075113,0.000061349,0.000086293,0.000082540,0.000095943,0.000058940,0.000083833,0.000082100,0.000059149,0.000083064,0.000084739,0.000024190,0.000025213,0.000020789,0.000033949,0.000015063,-0.000057911},
					  {-0.000007292,-0.000052944,-0.000005046,0.000008548,0.000051901,0.000061536,0.000054437,0.000069527,0.000069679,0.000072110,0.000076865,0.000110498,0.000097675,0.000083166,0.000069549,0.000052872,0.000065070,0.000049442,0.000039054,0.000038526,0.000031371,-0.000003228,-0.000060357,-0.000064787},
					  {-0.000080635,0.000006839,-0.000039805,0.000030630,0.000038534,0.000019625,0.000062616,0.000065983,0.000077347,0.000088885,0.000110983,0.000095894,0.000124258,0.000081295,0.000060076,0.000062417,0.000076389,0.000058875,0.000029195,0.000026247,0.000013128,-0.000027839,-0.000007291,0.000009164},
					  {0.000075298,0.000014224,0.000004307,0.000040117,0.000019550,0.000050445,0.000058396,0.000060416,0.000081555,0.000101992,0.000119776,0.000122137,0.000099904,0.000108879,0.000091081,0.000073887,0.000049011,0.000059852,0.000071401,0.000060120,0.000035000,0.000019517,-0.000007812,-0.000012672},
					  {-0.000053590,-0.000013665,0.000001694,0.000025405,0.000026078,0.000045990,0.000048994,0.000058902,0.000088934,0.000075313,0.000097603,0.000106649,0.000082214,0.000091803,0.000093480,0.000093847,0.000070098,0.000045010,0.000058947,0.000046931,0.000046796,0.000012454,-0.000034690,0.000022554},
					  {0.000004982,-0.000029061,0.000000683,0.000022002,0.000043167,0.000029314,0.000071654,0.000068094,0.000082108,0.000098661,0.000087551,0.000108982,0.000071345,0.000111688,0.000085760,0.000088648,0.000085837,0.000052058,0.000045763,0.000070438,0.000008502,0.000031372,-0.000026862,0.000000564},
					  {-0.000111215,-0.000087779,-0.000003841,-0.000006533,0.000018509,0.000056047,0.000049228,0.000079754,0.000077134,0.000082865,0.000100689,0.000100113,0.000107189,0.000089156,0.000090880,0.000070653,0.000083945,0.000089283,0.000058341,0.000052146,0.000060512,-0.000005704,0.000042412,0.000002229},
					  {-0.000056088,-0.000019214,-0.000032757,0.000017370,0.000017693,0.000049372,0.000073950,0.000061054,0.000068725,0.000091263,0.000108473,0.000103328,0.000118182,0.000085371,0.000089386,0.000091128,0.000074179,0.000089161,0.000068717,0.000069439,0.000032825,0.000047941,0.000017428,0.000036542},
					  {-0.000022815,0.000029822,0.000026414,-0.000006437,0.000048097,0.000026916,0.000082380,0.000092607,0.000060342,0.000085217,0.000091203,0.000086340,0.000083718,0.000106984,0.000091121,0.000073511,0.000076820,0.000051448,0.000045888,0.000046475,0.000058522,0.000022930,-0.000006478,-0.000012135}};


const float rochcor2012::dcor_ma[16][24]={{0.000108851,0.000053579,0.000016672,-0.000019577,-0.000046281,-0.000042821,-0.000050485,-0.000018393,-0.000036183,-0.000040292,-0.000068827,-0.000055965,-0.000054785,-0.000051683,-0.000057175,-0.000068177,-0.000066984,-0.000059800,-0.000083431,-0.000033722,0.000104230,0.000257752,0.000481939,0.000640355},
					  {0.000472010,0.000219678,0.000130966,0.000038573,0.000036905,0.000010582,-0.000013737,-0.000020654,-0.000005580,-0.000055530,-0.000045119,-0.000080969,-0.000039940,-0.000060168,-0.000056865,-0.000024194,0.000019653,0.000014380,0.000016977,0.000096955,0.000132681,0.000261374,0.000460563,0.000540731},
					  {0.000541133,0.000429687,0.000272283,0.000123206,0.000086378,-0.000002380,-0.000004129,-0.000004385,-0.000015870,-0.000018595,-0.000028998,-0.000025877,-0.000012611,-0.000041628,0.000000528,-0.000015810,0.000014407,0.000044934,0.000064325,0.000097814,0.000111191,0.000127340,0.000095623,0.000203553},
					  {0.000745882,0.000355858,0.000170637,0.000064381,0.000051553,0.000046900,0.000025438,0.000020672,0.000014774,-0.000003894,-0.000003997,-0.000016450,0.000007854,0.000015075,-0.000004819,0.000024581,0.000029016,0.000035240,0.000083915,0.000045604,0.000032167,-0.000012359,-0.000034323,0.000003944},
					  {0.000009727,0.000052742,0.000028369,0.000016887,-0.000005284,0.000032969,0.000029181,0.000037560,0.000044945,0.000012166,0.000043468,0.000027563,0.000037257,0.000030443,0.000017489,0.000027890,0.000030317,0.000005708,-0.000005955,0.000012035,-0.000020124,-0.000071775,-0.000284826,-0.000538387},
					  {-0.000090626,-0.000066309,-0.000059464,-0.000060784,0.000000793,-0.000009056,0.000055552,0.000028131,0.000049949,0.000066458,0.000054872,0.000063174,0.000055048,0.000043480,0.000040303,0.000037486,0.000042558,-0.000011707,-0.000023077,-0.000054673,-0.000090496,-0.000124178,-0.000109575,-0.000032171},
					  {-0.000442182,-0.000287161,-0.000104025,0.000028815,0.000022955,0.000015497,0.000029917,0.000022286,0.000069865,0.000051025,0.000085910,0.000082126,0.000079599,0.000050588,0.000054469,0.000022282,0.000023514,-0.000000083,-0.000050546,-0.000082588,-0.000107787,-0.000145963,-0.000254529,-0.000285777},
					  {-0.000546606,-0.000372281,-0.000193154,0.000015509,0.000100564,0.000137722,0.000118337,0.000076900,0.000080234,0.000058916,0.000058017,0.000061559,0.000079340,0.000059243,0.000068309,0.000058276,0.000065347,0.000053357,0.000041908,-0.000023515,-0.000046198,-0.000103105,-0.000158214,-0.000272825},
					  {-0.000530700,-0.000275533,-0.000144812,0.000014779,0.000095336,0.000112555,0.000103942,0.000079899,0.000077254,0.000054569,0.000070337,0.000083461,0.000073542,0.000086701,0.000057671,0.000045077,0.000048321,0.000052343,0.000091380,0.000108126,0.000058879,-0.000013731,-0.000018970,-0.000130416},
					  {-0.000178891,-0.000050961,0.000064877,0.000154434,0.000155737,0.000158017,0.000058857,0.000084624,0.000046888,0.000045494,0.000042858,0.000052991,0.000048903,0.000035540,0.000043636,0.000056224,0.000080681,0.000102996,0.000146596,0.000143674,0.000119691,0.000057319,0.000032262,0.000084765},
					  {-0.000065244,-0.000076538,0.000012233,0.000092194,0.000080316,0.000073335,0.000038026,0.000025852,0.000025476,0.000037337,0.000044664,0.000024951,0.000020577,0.000049579,0.000024349,0.000027469,0.000025238,0.000051741,0.000121469,0.000144803,0.000179298,0.000098972,0.000049003,0.000204044},
					  {-0.000130982,-0.000026930,-0.000041225,-0.000042819,0.000008702,0.000010144,-0.000002672,-0.000002399,-0.000013682,-0.000008915,0.000001298,-0.000003693,-0.000003298,-0.000026571,-0.000002507,0.000013820,0.000003293,0.000019233,-0.000007831,0.000034706,0.000063851,0.000107006,0.000119439,-0.000067710},
					  {0.000131353,-0.000013120,0.000026857,-0.000027287,-0.000028900,-0.000029739,-0.000052447,-0.000031652,-0.000037272,-0.000016441,-0.000033501,-0.000054467,-0.000042773,-0.000045043,-0.000069021,-0.000024175,-0.000020286,-0.000045185,-0.000052762,-0.000057367,-0.000011301,-0.000030970,0.000027139,0.000386404},
					  {0.000305996,0.000208720,0.000103637,-0.000025774,-0.000077658,-0.000081662,-0.000068720,-0.000052208,-0.000032603,-0.000033191,-0.000041862,-0.000053413,-0.000043330,-0.000049510,-0.000084768,-0.000087598,-0.000075902,-0.000092525,-0.000109065,-0.000103125,-0.000128912,-0.000052918,0.000068953,0.000312260},
					  {-0.000095470,0.000080003,0.000061194,-0.000026791,-0.000009977,-0.000063041,-0.000053199,-0.000037035,-0.000052414,-0.000036956,-0.000055416,-0.000062056,-0.000065769,-0.000077155,-0.000071953,-0.000100060,-0.000126885,-0.000111944,-0.000165172,-0.000140132,-0.000078335,0.000039939,0.000119456,0.000254795},
					  {0.000073851,0.000078182,0.000061904,-0.000015538,-0.000024809,-0.000056718,-0.000059624,-0.000045610,-0.000061430,-0.000051322,-0.000066957,-0.000086036,-0.000069440,-0.000074214,-0.000078827,-0.000096600,-0.000115314,-0.000098835,-0.000157463,-0.000132925,-0.000086763,0.000102281,0.000401291,0.000646291}};


const float rochcor2012::mcor_bf[16][24]={{-0.000052783,-0.000056457,-0.000019302,-0.000031534,-0.000003682,-0.000005769,0.000006798,0.000015656,0.000008159,0.000014357,0.000022948,0.000024360,0.000018594,0.000020435,0.000011885,0.000010995,0.000016201,0.000006429,0.000003797,-0.000008395,-0.000017941,-0.000049589,-0.000037227,-0.000046156},
					  {-0.000093532,-0.000047777,-0.000017454,-0.000038176,-0.000009327,0.000000405,0.000002710,0.000013468,0.000004128,0.000022860,0.000020560,0.000025774,0.000023163,0.000021331,0.000022465,0.000006113,0.000013840,0.000003814,-0.000000148,-0.000012613,-0.000009252,-0.000038942,-0.000049642,-0.000070497},
					  {-0.000056429,-0.000039033,-0.000030170,-0.000018122,-0.000016990,0.000001287,0.000008434,0.000025308,0.000012948,0.000028602,0.000021947,0.000021716,0.000025726,0.000027201,0.000023730,0.000013144,0.000008291,0.000012215,-0.000007334,-0.000017127,-0.000026698,-0.000021626,-0.000046126,-0.000059409},
					  {-0.000044381,-0.000047695,-0.000020653,-0.000020660,-0.000023132,-0.000009699,0.000008276,0.000020689,0.000018158,0.000018873,0.000019713,0.000018573,0.000031437,0.000021716,0.000020093,0.000003184,0.000010147,-0.000002120,0.000001141,-0.000006572,-0.000025658,-0.000016643,-0.000027643,-0.000054871},
					  {-0.000058778,-0.000050318,-0.000031920,-0.000004491,-0.000006834,0.000000958,0.000019450,0.000013434,0.000015369,0.000010793,0.000018527,0.000015659,0.000006921,0.000005826,0.000012120,-0.000003283,0.000014410,0.000000411,-0.000008418,-0.000016905,-0.000014077,-0.000029825,-0.000042154,-0.000098440},
					  {-0.000090980,-0.000033684,-0.000019125,-0.000018186,-0.000009939,0.000009790,0.000006351,0.000009267,0.000005597,0.000014679,0.000019196,0.000016489,0.000024870,0.000018932,0.000008533,0.000022223,0.000008051,0.000012413,0.000000726,-0.000000721,-0.000025164,-0.000017655,-0.000050868,-0.000087311},
					  {-0.000090757,-0.000063075,-0.000032423,-0.000002802,-0.000007938,0.000009180,0.000013763,0.000024048,0.000010143,0.000012066,0.000020422,0.000027093,0.000021223,0.000018249,0.000014204,0.000000580,0.000008517,0.000007189,-0.000014971,-0.000008874,-0.000022130,-0.000035360,-0.000047957,-0.000101726},
					  {-0.000061536,-0.000062830,-0.000019862,-0.000002697,-0.000012762,-0.000003043,-0.000000997,0.000011916,0.000025569,0.000011891,0.000018886,0.000022184,0.000016087,0.000018569,0.000017425,0.000018333,0.000005043,0.000018490,0.000002919,-0.000006364,-0.000015554,-0.000038197,-0.000052140,-0.000086322},
					  {-0.000048234,-0.000051525,-0.000021234,-0.000012384,0.000008342,0.000007676,0.000009319,0.000014069,0.000014498,0.000027271,0.000015501,0.000026879,0.000028081,0.000021742,0.000024738,0.000011093,0.000006292,0.000012878,0.000008643,-0.000014945,-0.000005404,-0.000030282,-0.000022994,-0.000082441},
					  {-0.000077423,-0.000040396,-0.000025954,-0.000005173,-0.000001554,-0.000005774,0.000002251,0.000007360,0.000013956,0.000022905,0.000023843,0.000023129,0.000027700,0.000023671,0.000016390,0.000006341,0.000009378,0.000001008,-0.000006572,-0.000012159,-0.000010236,-0.000019412,-0.000069524,-0.000076115},
					  {-0.000036300,-0.000001730,-0.000020405,-0.000019307,-0.000012576,-0.000001727,0.000016747,0.000015334,0.000011051,0.000025514,0.000026049,0.000028155,0.000023027,0.000022465,0.000016297,0.000009736,-0.000001287,0.000006161,0.000001690,-0.000008591,-0.000008093,-0.000030061,-0.000067913,-0.000096766},
					  {-0.000055863,-0.000051285,-0.000024109,-0.000020342,-0.000012477,0.000001663,0.000018101,0.000017554,0.000019930,0.000014063,0.000015646,0.000027437,0.000023710,0.000013308,0.000031626,0.000020101,0.000007821,0.000006838,-0.000004091,-0.000012198,-0.000005268,-0.000003445,-0.000037435,-0.000064032},
					  {-0.000069760,-0.000041185,-0.000030945,-0.000016793,-0.000022093,0.000002323,0.000005258,0.000020217,0.000019182,0.000016739,0.000025471,0.000025347,0.000022937,0.000024074,0.000022304,0.000017398,0.000016912,0.000006403,-0.000006838,-0.000007763,-0.000014911,-0.000034220,-0.000045312,-0.000034503},
					  {-0.000086538,-0.000075776,-0.000032541,-0.000021355,-0.000020030,0.000013785,0.000005543,0.000013063,0.000010813,0.000019412,0.000016503,0.000014637,0.000016070,0.000026737,0.000023952,0.000009304,0.000007551,0.000006143,-0.000001465,-0.000000557,-0.000006969,-0.000013853,-0.000041246,-0.000053886},
					  {-0.000101006,-0.000051708,-0.000034597,-0.000026491,-0.000022102,-0.000023828,0.000010228,0.000015111,0.000010177,0.000012250,0.000027810,0.000024433,0.000031882,0.000024156,0.000018080,0.000012818,0.000017220,0.000008907,0.000013091,0.000009411,-0.000028717,-0.000036704,-0.000042276,-0.000051789},
					  {-0.000060291,-0.000060433,-0.000039167,-0.000017775,-0.000011375,-0.000003421,0.000007362,0.000016579,0.000022269,0.000021122,0.000024353,0.000022596,0.000018700,0.000029581,0.000014846,0.000011633,0.000008433,0.000002833,0.000009112,-0.000011903,-0.000005906,-0.000035066,-0.000047606,-0.000097203}};


const float rochcor2012::mcor_ma[16][24]={{0.000388515,0.000327814,0.000179791,0.000059819,-0.000018770,-0.000013464,-0.000062249,-0.000041450,-0.000048462,-0.000057871,-0.000065031,-0.000059870,-0.000050776,-0.000052646,-0.000055648,-0.000053031,-0.000056097,-0.000072483,-0.000058343,-0.000049967,-0.000060403,-0.000080739,-0.000059845,0.000057610},
					  {0.000228883,0.000190506,0.000158820,0.000067200,0.000015079,-0.000037583,-0.000042208,-0.000067478,-0.000054373,-0.000058527,-0.000058226,-0.000072326,-0.000061393,-0.000060157,-0.000058221,-0.000071201,-0.000068851,-0.000098450,-0.000145174,-0.000126837,-0.000017335,0.000173849,0.000302451,0.000385340},
					  {0.000534270,0.000133004,-0.000003092,-0.000001230,-0.000008231,-0.000049322,-0.000062091,-0.000046346,-0.000056719,-0.000044666,-0.000044374,-0.000051149,-0.000045566,-0.000052897,-0.000053940,-0.000042784,-0.000041786,-0.000047563,-0.000029358,0.000014058,0.000117526,0.000315511,0.000450528,0.000450869},
					  {-0.000092612,0.000023008,0.000002388,-0.000065446,-0.000072546,-0.000065450,-0.000064712,-0.000037571,-0.000036887,-0.000037679,-0.000028707,-0.000036891,-0.000020632,-0.000029084,-0.000022863,-0.000024022,-0.000008414,-0.000001509,0.000015173,0.000020147,-0.000000516,-0.000059561,-0.000063503,-0.000013514},
					  {-0.000011316,-0.000062137,-0.000104482,-0.000097368,-0.000070572,-0.000050418,-0.000025256,-0.000010727,-0.000010489,-0.000009819,-0.000006334,-0.000007485,-0.000006882,-0.000000273,-0.000007675,0.000021014,0.000010647,0.000027027,0.000042502,0.000044245,-0.000008163,-0.000131856,-0.000271937,-0.000265647},
					  {0.000088890,-0.000017028,-0.000012838,-0.000004606,0.000040106,0.000056308,0.000031501,0.000013834,0.000023516,0.000018901,0.000021596,0.000019853,0.000010833,0.000020290,0.000030125,0.000027855,0.000037914,0.000048087,0.000047301,0.000078406,0.000100617,0.000180410,0.000213449,0.000100952},
					  {0.000211224,0.000228802,0.000237924,0.000206222,0.000138763,0.000127009,0.000068888,0.000050184,0.000045841,0.000040108,0.000041493,0.000039511,0.000045252,0.000049539,0.000038515,0.000047968,0.000060531,0.000065897,0.000079002,0.000081001,0.000111694,0.000104614,0.000025317,-0.000007088},
					  {0.000173752,0.000212077,0.000216962,0.000178071,0.000111019,0.000095712,0.000074157,0.000057835,0.000060629,0.000056490,0.000048239,0.000036237,0.000038792,0.000046983,0.000057630,0.000057841,0.000073460,0.000062234,0.000091321,0.000117003,0.000167542,0.000222364,0.000265639,0.000205927},
					  {0.000372582,0.000323362,0.000230914,0.000148478,0.000104692,0.000080077,0.000069697,0.000068077,0.000071430,0.000050849,0.000056646,0.000055453,0.000061268,0.000065451,0.000055607,0.000053475,0.000059046,0.000071657,0.000091642,0.000123250,0.000131513,0.000103873,0.000123295,0.000152751},
					  {0.000120434,0.000134023,0.000139851,0.000109030,0.000098962,0.000096265,0.000063130,0.000063925,0.000056661,0.000062514,0.000052079,0.000054391,0.000055302,0.000055157,0.000046546,0.000050565,0.000051575,0.000055385,0.000050812,0.000064887,0.000107486,0.000160702,0.000282435,0.000418342},
					  {-0.000215045,-0.000146864,-0.000044798,0.000009304,0.000041042,0.000040632,0.000051004,0.000040087,0.000042228,0.000057075,0.000048739,0.000054406,0.000049017,0.000052663,0.000042367,0.000030208,0.000035740,0.000028830,0.000004115,-0.000004984,-0.000009705,-0.000019274,0.000001178,-0.000005278},
					  {-0.000737129,-0.000435947,-0.000232054,-0.000092606,-0.000051978,-0.000005328,0.000013968,0.000013301,0.000024349,0.000035275,0.000035560,0.000038086,0.000025332,0.000021941,0.000035861,0.000033767,0.000028326,0.000020662,0.000019052,0.000017753,0.000024989,0.000115021,0.000288867,0.000527408},
					  {-0.000892935,-0.000537239,-0.000292331,-0.000114824,-0.000033569,-0.000004622,-0.000007637,0.000001743,0.000006536,0.000001984,0.000014662,0.000003092,-0.000000027,0.000009391,-0.000001707,0.000008520,0.000019500,0.000017849,0.000020954,0.000011357,0.000004751,-0.000046692,-0.000069299,0.000096323},
					  {-0.000196331,0.000032833,0.000024635,-0.000004315,-0.000038270,-0.000039997,-0.000020041,-0.000033896,-0.000020713,-0.000011938,-0.000027502,-0.000014733,-0.000021259,-0.000019041,-0.000017563,-0.000028235,-0.000018464,-0.000034246,-0.000029391,-0.000032105,-0.000027316,0.000007501,0.000030738,-0.000146240},
					  {0.000164125,0.000044950,0.000003090,-0.000031162,-0.000026685,-0.000038291,-0.000046918,-0.000056198,-0.000043231,-0.000051143,-0.000038265,-0.000043870,-0.000037774,-0.000037081,-0.000033375,-0.000048670,-0.000032679,-0.000031420,-0.000040844,-0.000050021,-0.000101292,-0.000221697,-0.000310150,-0.000376054},
					  {0.000419807,0.000348313,0.000207566,0.000036678,-0.000031968,-0.000064725,-0.000075518,-0.000059007,-0.000063580,-0.000055989,-0.000064077,-0.000054669,-0.000060103,-0.000047812,-0.000061279,-0.000065380,-0.000066727,-0.000037122,-0.000025946,-0.000049614,-0.000141625,-0.000323803,-0.000452114,-0.000531286}};


//==========================================================================================================================

const float rochcor2012::dmavg[16][24]={{0.026242311,0.025981421,0.025730122,0.025311096,0.025136923,0.024969848,0.025013624,0.024833870,0.024912888,0.025121655,0.025229635,0.025413356,0.025393010,0.025328388,0.025124801,0.024899470,0.024894886,0.024855252,0.024970969,0.025083886,0.025372199,0.025656988,0.026506677,0.026827304},
					{0.026704020,0.026068750,0.025861069,0.025190836,0.024899939,0.025093627,0.024976497,0.025017027,0.025066414,0.024974362,0.025344451,0.025450436,0.025313491,0.025212092,0.025071753,0.025070600,0.024960167,0.024952666,0.025131268,0.025163834,0.025222199,0.025793736,0.026238274,0.026590795},
					{0.026410538,0.025890923,0.025541291,0.025060208,0.025210905,0.025027950,0.025153037,0.025017271,0.025012862,0.025311869,0.025323205,0.025461256,0.025606056,0.025359387,0.025251431,0.025104448,0.025020269,0.025074446,0.025098163,0.024951349,0.025295807,0.025248347,0.026034131,0.026131866},
					{0.026707850,0.026142349,0.025652613,0.025276532,0.025074111,0.024979532,0.024853611,0.024949033,0.025007393,0.025247321,0.025366176,0.025413978,0.025392982,0.025419456,0.025293440,0.025108796,0.024944413,0.024890622,0.024983919,0.024891619,0.025146015,0.025328419,0.025665599,0.026137263},
					{0.025981149,0.025701760,0.025488471,0.024955597,0.024943416,0.024887868,0.025049204,0.025042687,0.025087216,0.025191486,0.025417269,0.025480570,0.025487069,0.025318687,0.025312641,0.025116002,0.025103278,0.025009575,0.024975210,0.025113800,0.025049107,0.025350668,0.025508909,0.025475850},
					{0.026119462,0.025770801,0.025510218,0.025213156,0.025134612,0.025028213,0.024859969,0.025124564,0.025024260,0.025325156,0.025190999,0.025455577,0.025450404,0.025294634,0.025160640,0.025118445,0.025155571,0.024925458,0.024859580,0.025113659,0.024999051,0.025396292,0.025462964,0.025960822},
					{0.026079429,0.025593219,0.025422940,0.025428893,0.025345926,0.025026479,0.025011545,0.024924862,0.025086818,0.025169383,0.025339916,0.025446660,0.025403763,0.025394320,0.025335617,0.025059062,0.025032442,0.025112743,0.024975458,0.024970645,0.025128265,0.025417647,0.025521300,0.026083436},
					{0.025919527,0.025772569,0.025431478,0.025148131,0.025076380,0.025125245,0.024969885,0.025120460,0.025205664,0.025092277,0.025481078,0.025573278,0.025724807,0.025221759,0.025331779,0.025261834,0.025189147,0.025033076,0.025177360,0.025247515,0.025176636,0.025430627,0.025539490,0.025987475},
					{0.026007511,0.025968080,0.025534211,0.025318362,0.025263911,0.025021661,0.024987632,0.025110005,0.025038896,0.025201829,0.025478075,0.025247870,0.025401296,0.025409067,0.025288595,0.025066313,0.024910641,0.025167959,0.025202584,0.025114615,0.025450554,0.025644557,0.025994884,0.025997166},
					{0.026397319,0.025856468,0.025730274,0.025665389,0.025240909,0.025260981,0.024983265,0.025058809,0.025015312,0.024976001,0.025042898,0.025396540,0.025307123,0.025327097,0.025250223,0.025231412,0.025052818,0.025008034,0.025159986,0.025302076,0.025436859,0.025522578,0.025764416,0.026000363},
					{0.025859980,0.025874050,0.025499350,0.025317168,0.025268376,0.024890134,0.025118277,0.024906363,0.025029057,0.025131638,0.025483542,0.025291092,0.025398410,0.025433123,0.025259248,0.025111809,0.025202312,0.025040694,0.025014689,0.025170645,0.025337914,0.025532607,0.025860252,0.026253441},
					{0.025992581,0.025715301,0.025477770,0.025245197,0.025122651,0.024939000,0.024925873,0.025031629,0.024916522,0.025242530,0.025217031,0.025245278,0.025529647,0.025015068,0.025065690,0.025025883,0.024960212,0.025146059,0.024865689,0.025172671,0.025286321,0.025637988,0.026043767,0.026041056},
					{0.026251907,0.025830953,0.025505841,0.025161500,0.024967829,0.025175296,0.025009917,0.024895269,0.025029782,0.025276674,0.025189704,0.025312077,0.025252349,0.025434894,0.025214028,0.025028026,0.025087678,0.025090101,0.025019494,0.024966990,0.025454261,0.025528548,0.025885557,0.026258768},
					{0.026473057,0.026138013,0.025655903,0.025241247,0.025087496,0.024961784,0.024962795,0.024910599,0.024943289,0.025251845,0.025145453,0.025383327,0.025334646,0.025090037,0.025094066,0.025079030,0.024897989,0.024987106,0.024918229,0.025007999,0.025071772,0.025515539,0.026026912,0.026226804},
					{0.025881199,0.026141720,0.025618126,0.025347707,0.025172073,0.024936870,0.025031129,0.025046939,0.024880103,0.025198349,0.025185534,0.025193894,0.025345850,0.025217397,0.025061234,0.025059139,0.024879376,0.024751714,0.024790274,0.024835660,0.025173218,0.025431776,0.025931848,0.026201549},
					{0.026134513,0.025873901,0.025633224,0.025189258,0.024973491,0.024923348,0.024828692,0.024817906,0.025031016,0.025177823,0.025246081,0.025472611,0.025615373,0.025189806,0.025270551,0.025006467,0.025010752,0.024952708,0.025001652,0.025023603,0.025146804,0.025676230,0.026012215,0.026363731}};


const float rochcor2012::dpavg[16][24]={{0.026015898,0.026139431,0.025742965,0.025478150,0.025114652,0.025029538,0.025070865,0.025153545,0.025040417,0.025148273,0.025429956,0.025497619,0.025518260,0.025318126,0.025142124,0.025037842,0.025065867,0.025050423,0.025076216,0.025050192,0.025246910,0.025602503,0.025834671,0.026118592},
					{0.026107627,0.025631814,0.025460031,0.025235142,0.024925347,0.024909482,0.025071699,0.025009311,0.025217857,0.025293232,0.025326159,0.025426251,0.025428858,0.025343273,0.025296052,0.024985027,0.024935043,0.024925447,0.024926618,0.025002368,0.025212742,0.025304142,0.025536146,0.025762290},
					{0.025549363,0.025313578,0.025067475,0.025024687,0.024933605,0.025050487,0.024968177,0.024969969,0.025149040,0.025085074,0.025312078,0.025645576,0.025345657,0.025575071,0.025225292,0.025282760,0.024965059,0.024839274,0.024853661,0.024886528,0.025024733,0.025381787,0.025828452,0.025592987},
					{0.025708588,0.025431500,0.025258313,0.025050727,0.024799418,0.024759852,0.024949516,0.025037741,0.025075021,0.025274168,0.025303256,0.025445766,0.025424237,0.025275688,0.025175897,0.025179207,0.025091292,0.024952286,0.024841875,0.025083821,0.024973363,0.025381080,0.025755055,0.026176293},
					{0.026089777,0.025873611,0.025408500,0.025404404,0.025102291,0.024780491,0.024888512,0.025055021,0.025081713,0.025285771,0.025414757,0.025531266,0.025536294,0.025342921,0.025281071,0.025079678,0.025172597,0.024982794,0.025033508,0.025218197,0.025381652,0.025559438,0.025936495,0.026450566},
					{0.026368576,0.025936618,0.025644362,0.025463971,0.025126177,0.025144222,0.024874735,0.024920696,0.025025826,0.025071895,0.025237601,0.025478835,0.025209530,0.025293706,0.025118685,0.025098931,0.025006429,0.025054197,0.024883095,0.025246607,0.025456476,0.025579130,0.026221151,0.025962645},
					{0.026431468,0.026313507,0.025771077,0.025202593,0.025167678,0.024936022,0.024938930,0.025123808,0.025026909,0.025289669,0.025267467,0.025411737,0.025329834,0.025256447,0.025119001,0.025115216,0.025036309,0.025119028,0.024917817,0.025258634,0.025344652,0.025592053,0.025945620,0.026521842},
					{0.026881754,0.026216311,0.025931947,0.025390597,0.024915381,0.024732673,0.024661278,0.024965860,0.025049210,0.025122126,0.025241463,0.025333738,0.025503281,0.025261324,0.025190932,0.025089079,0.024955429,0.024918816,0.025027062,0.025155314,0.025336596,0.025713868,0.025955453,0.026467446},
					{0.026832588,0.026368427,0.025885661,0.025521045,0.025123160,0.024871556,0.024712617,0.024864900,0.025066534,0.025142411,0.025412684,0.025222890,0.025466525,0.025225580,0.025169155,0.024951105,0.024938959,0.025023032,0.025067616,0.024896271,0.025328773,0.025419813,0.026011776,0.026186992},
					{0.026674589,0.026131576,0.025773418,0.025359766,0.025184250,0.024953856,0.024883110,0.024902405,0.025072594,0.025176108,0.025003795,0.025258729,0.025176954,0.025169230,0.025075927,0.025019477,0.024985163,0.024884322,0.024904732,0.024751147,0.025416741,0.025688910,0.026026610,0.026140407},
					{0.026211806,0.025920072,0.025655836,0.025035102,0.025037877,0.024902444,0.025094544,0.025116695,0.025020181,0.025235952,0.025262168,0.025139457,0.025438926,0.025177358,0.025115226,0.025174560,0.024775223,0.024911016,0.024918883,0.024900484,0.025088262,0.025420211,0.025698640,0.026095253},
					{0.026382727,0.025992601,0.025657091,0.025409300,0.025133970,0.024882391,0.025132524,0.025006125,0.025128347,0.025175687,0.025086725,0.025288934,0.025324006,0.025446454,0.025182622,0.025022142,0.025023823,0.024986381,0.024974959,0.025148991,0.025248241,0.025394269,0.025716053,0.025962236},
					{0.026068487,0.026091552,0.025716934,0.025288673,0.024895603,0.025007852,0.024890802,0.025058394,0.025129748,0.025008821,0.025362208,0.025411899,0.025376889,0.025191360,0.025180879,0.025142309,0.024988365,0.025119358,0.025045158,0.025044612,0.025334251,0.025677054,0.025843175,0.026074536},
					{0.026280667,0.025797365,0.025725990,0.025527116,0.025191617,0.025203754,0.025013039,0.024858785,0.025004671,0.025211620,0.025099404,0.025409295,0.025352222,0.025247232,0.025235188,0.025103691,0.025041485,0.024932963,0.025129761,0.025223032,0.025299631,0.025596446,0.025963774,0.026005775},
					{0.026347961,0.025922572,0.025649666,0.025341124,0.025016248,0.025010793,0.025186570,0.025015341,0.025075677,0.025154504,0.025256242,0.025369682,0.025531496,0.025484397,0.025107669,0.025163148,0.025193356,0.025077107,0.024957543,0.025088906,0.025483467,0.025307009,0.025687449,0.025968850},
					{0.026207966,0.025663053,0.025239108,0.025223062,0.025073533,0.025195111,0.025002975,0.025050518,0.025108682,0.025275307,0.025442262,0.025483339,0.025546658,0.025399154,0.025243266,0.025128645,0.025087935,0.025258750,0.025212932,0.025251467,0.025275511,0.025428940,0.025531070,0.025803984}};


const float rochcor2012::mmavg[16][24]={{0.026357141,0.025980327,0.025428822,0.025165614,0.024962498,0.024902805,0.024889691,0.024945619,0.025125622,0.025271907,0.025391313,0.025501161,0.025507783,0.025362926,0.025242242,0.025123629,0.024892710,0.024924635,0.024922262,0.024994358,0.025128579,0.025411863,0.025582038,0.026045091},
					{0.026148619,0.025786187,0.025465485,0.025205477,0.024962021,0.024869622,0.024930634,0.024931918,0.025043359,0.025351610,0.025462296,0.025553301,0.025516285,0.025394445,0.025255397,0.025029935,0.024950928,0.024895197,0.024843668,0.024847120,0.025169113,0.025591087,0.025821726,0.026317392},
					{0.026249662,0.025653257,0.025287770,0.025051675,0.024890010,0.024871072,0.024914002,0.025093635,0.025158169,0.025288047,0.025514978,0.025601364,0.025605034,0.025449242,0.025272420,0.025144690,0.024985676,0.024847073,0.024858568,0.024950978,0.025241799,0.025625796,0.026053786,0.026271534},
					{0.025846925,0.025593716,0.025234463,0.024968531,0.024864159,0.024814745,0.024884685,0.025004061,0.025208960,0.025362160,0.025553554,0.025732779,0.025704279,0.025513188,0.025367990,0.025222522,0.025077327,0.024999121,0.024859909,0.024908437,0.025079315,0.025253279,0.025517999,0.025968186},
					{0.026043387,0.025560139,0.025203958,0.025007552,0.024863991,0.024871385,0.024903257,0.024904757,0.025145534,0.025348903,0.025538158,0.025628839,0.025711845,0.025494373,0.025420616,0.025227784,0.025119513,0.025016457,0.025046740,0.025043595,0.025105347,0.025206351,0.025409446,0.025605694},
					{0.026035400,0.025830809,0.025326027,0.025144430,0.024996546,0.024977368,0.024968867,0.025026589,0.025196863,0.025338131,0.025521911,0.025589797,0.025562127,0.025535124,0.025346439,0.025180693,0.024979168,0.024981797,0.025003160,0.025010460,0.025210547,0.025532200,0.025867819,0.026067224},
					{0.026139460,0.026050937,0.025562477,0.025264594,0.025104477,0.025036544,0.024969161,0.025163966,0.025200039,0.025373185,0.025477227,0.025602434,0.025627297,0.025540412,0.025401836,0.025253632,0.025060675,0.025001987,0.024915745,0.025088041,0.025246686,0.025434509,0.025795473,0.025820704},
					{0.026110218,0.025851658,0.025581729,0.025260079,0.025094830,0.025048824,0.024917520,0.025093200,0.025171566,0.025358709,0.025481033,0.025678032,0.025568956,0.025546794,0.025336399,0.025236542,0.025110754,0.025005745,0.025038742,0.025063243,0.025262636,0.025524587,0.025910743,0.026082833},
					{0.026402260,0.025932304,0.025606185,0.025273533,0.025112991,0.025042971,0.025010340,0.025086416,0.025160346,0.025333663,0.025524340,0.025570735,0.025634678,0.025486744,0.025350430,0.025184630,0.025065711,0.025062725,0.025043599,0.025159759,0.025200865,0.025419966,0.025708143,0.026260404},
					{0.026094068,0.025922979,0.025515379,0.025246560,0.025073582,0.024896822,0.025011422,0.025007714,0.025187944,0.025295049,0.025382311,0.025556016,0.025581424,0.025531670,0.025332778,0.025235556,0.025077420,0.024991026,0.024922093,0.025078006,0.025122634,0.025525194,0.025835669,0.026246943},
					{0.025856224,0.025570829,0.025363919,0.025187211,0.025034707,0.025028791,0.024982356,0.025093074,0.025168554,0.025408495,0.025562750,0.025611548,0.025685096,0.025508222,0.025383262,0.025220130,0.025046562,0.024973194,0.024968229,0.025019721,0.025146412,0.025328458,0.025659871,0.025914880},
					{0.025351240,0.025338857,0.025125583,0.025010428,0.024932002,0.024966940,0.024927421,0.025016375,0.025249119,0.025363917,0.025616169,0.025689549,0.025661981,0.025483809,0.025388021,0.025199103,0.025020013,0.024959224,0.024938736,0.025038499,0.025051134,0.025561581,0.025703409,0.026456681},
					{0.025264026,0.025257986,0.025229048,0.024989338,0.024968357,0.024885265,0.024957939,0.025039541,0.025163257,0.025346028,0.025502784,0.025535251,0.025605146,0.025610118,0.025314716,0.025143416,0.024982696,0.024901987,0.024902827,0.025035174,0.025076476,0.025253395,0.025582447,0.026165577},
					{0.025799175,0.025738031,0.025444530,0.025036571,0.024862708,0.024980890,0.025008904,0.024934838,0.025140832,0.025268253,0.025442773,0.025522078,0.025571318,0.025444425,0.025256801,0.025133388,0.025009386,0.024909863,0.024907057,0.024875931,0.025173116,0.025363874,0.025764174,0.025881012},
					{0.026211899,0.025691421,0.025375388,0.025140668,0.024977129,0.024915457,0.024975080,0.024963344,0.025074388,0.025227202,0.025511409,0.025535389,0.025594919,0.025436953,0.025279872,0.025182811,0.025037891,0.024988481,0.024929322,0.024939129,0.024965854,0.025267006,0.025424539,0.025701572},
					{0.026388226,0.026044492,0.025489191,0.025114196,0.024912291,0.024851440,0.024898003,0.025000032,0.025130792,0.025277874,0.025477678,0.025572225,0.025540999,0.025471245,0.025220685,0.025097564,0.025005565,0.024810339,0.024909071,0.024933118,0.025010196,0.025138673,0.025318229,0.025500324}};


const float rochcor2012::mpavg[16][24]={{0.025931550,0.025545378,0.025293725,0.025176750,0.025031959,0.024911204,0.024973073,0.025023825,0.025249024,0.025414723,0.025552150,0.025585229,0.025646257,0.025553226,0.025373475,0.025163399,0.025127310,0.024995262,0.024943942,0.025036617,0.025286015,0.025533389,0.025836202,0.026011489},
					{0.025887463,0.025617095,0.025193872,0.025015293,0.024965662,0.024964363,0.024947925,0.025096143,0.025221043,0.025391845,0.025563684,0.025676364,0.025646901,0.025555294,0.025405184,0.025233972,0.025037738,0.024997128,0.024961280,0.025065372,0.025116717,0.025261251,0.025605676,0.025814226},
					{0.025540188,0.025549985,0.025458238,0.025097589,0.025001573,0.024915133,0.024944567,0.025043278,0.025215839,0.025418294,0.025617480,0.025666568,0.025707519,0.025530704,0.025401052,0.025177801,0.025031842,0.024976862,0.024931290,0.024919239,0.025025204,0.025176230,0.025460354,0.025723996},
					{0.026023446,0.025639710,0.025409841,0.025102813,0.024962196,0.024910026,0.025000177,0.025084237,0.025205382,0.025407421,0.025675506,0.025675866,0.025708751,0.025622698,0.025400062,0.025246160,0.025075362,0.024965351,0.024958420,0.024892382,0.025163247,0.025412763,0.025650647,0.026076700},
					{0.026304110,0.025817175,0.025631333,0.025198244,0.024968186,0.024929404,0.024973794,0.025041717,0.025228414,0.025334291,0.025614151,0.025655506,0.025719876,0.025649643,0.025405149,0.025240595,0.025108265,0.024881809,0.024878651,0.024970054,0.025153912,0.025558856,0.026124669,0.026128054},
					{0.026117231,0.025686940,0.025498978,0.025209332,0.024972880,0.024866997,0.024939264,0.025003101,0.025166737,0.025373926,0.025475519,0.025555775,0.025638684,0.025460234,0.025329412,0.025153008,0.025006124,0.024878676,0.024881256,0.024898167,0.025056802,0.025295352,0.025598344,0.026006398},
					{0.025964249,0.025506044,0.025280439,0.025005344,0.024972745,0.024841649,0.024811362,0.024962860,0.025096148,0.025211613,0.025481734,0.025578324,0.025642542,0.025420746,0.025318383,0.025062634,0.024937527,0.024909622,0.024970695,0.024955676,0.024999140,0.025362603,0.025773556,0.026033296},
					{0.026032176,0.025683417,0.025170723,0.024995517,0.024882170,0.024894855,0.024891798,0.024882380,0.025072075,0.025266884,0.025400367,0.025577925,0.025567243,0.025446958,0.025265693,0.025086784,0.024990607,0.024958956,0.024945100,0.024841593,0.025050855,0.025302049,0.025639317,0.025850824},
					{0.025839096,0.025637965,0.025234891,0.024997937,0.024923807,0.024861144,0.024908423,0.024998597,0.025082213,0.025222318,0.025443855,0.025634094,0.025561401,0.025481473,0.025202222,0.025115772,0.024962927,0.024869175,0.024824615,0.024879891,0.025093227,0.025446411,0.025675504,0.026013701},
					{0.026125985,0.025748854,0.025399770,0.025010607,0.024875162,0.024845113,0.024887182,0.024985190,0.025082941,0.025261982,0.025482476,0.025619646,0.025559438,0.025345874,0.025258563,0.025097691,0.024977830,0.024929355,0.024891335,0.024956480,0.025037187,0.025223352,0.025553975,0.025729286},
					{0.026223874,0.025890110,0.025446888,0.025107885,0.024869740,0.024862485,0.024847439,0.024957885,0.025140251,0.025307388,0.025625980,0.025627811,0.025569544,0.025498730,0.025313791,0.025061768,0.024989709,0.024872761,0.024816506,0.024897285,0.025187576,0.025446673,0.025825304,0.026000714},
					{0.026548082,0.026108546,0.025584119,0.025297604,0.024952490,0.024940818,0.024923730,0.025072615,0.025187876,0.025290696,0.025491852,0.025667628,0.025634247,0.025520324,0.025300291,0.025112495,0.025078652,0.024928594,0.024907071,0.025010014,0.025137351,0.025370805,0.025544062,0.025736909},
					{0.026767376,0.026246523,0.025690233,0.025239260,0.025040751,0.024967474,0.025027086,0.025047182,0.025188335,0.025336505,0.025511385,0.025647747,0.025637073,0.025592105,0.025318981,0.025178162,0.025064643,0.024934339,0.024956619,0.025026701,0.025133429,0.025510690,0.025776057,0.026018375},
					{0.026298495,0.025942220,0.025478742,0.025235233,0.025101633,0.024922236,0.024975222,0.025075624,0.025158259,0.025369955,0.025499271,0.025574597,0.025635066,0.025481974,0.025309449,0.025150986,0.025000510,0.024955300,0.024976190,0.024952358,0.025098782,0.025337376,0.025732056,0.026092921},
					{0.025969334,0.025750247,0.025359258,0.025271127,0.025025049,0.024933095,0.025014986,0.025056406,0.025190667,0.025360735,0.025569101,0.025642521,0.025619830,0.025532005,0.025342403,0.025143236,0.024985938,0.024961829,0.025042938,0.025067997,0.025128346,0.025615683,0.025975103,0.026441280},
					{0.025746729,0.025465854,0.025287844,0.025043581,0.025015758,0.024959078,0.025019960,0.025063077,0.025228159,0.025421005,0.025550712,0.025621532,0.025673042,0.025530546,0.025326120,0.025142797,0.025069799,0.024982519,0.024924035,0.025056983,0.025252595,0.025699461,0.026117797,0.026568095}};


//==========================================================================================================================

const float rochcor2012::dcor_bfer[16][24]={{0.000068153,0.000061059,0.000042379,0.000039876,0.000041060,0.000038680,0.000037244,0.000036566,0.000034915,0.000034630,0.000035163,0.000035047,0.000034797,0.000034949,0.000034482,0.000034995,0.000036782,0.000037567,0.000038937,0.000041177,0.000042827,0.000042102,0.000060168,0.000064936},
					    {0.000069548,0.000061729,0.000042743,0.000042676,0.000040073,0.000037608,0.000036606,0.000035547,0.000034354,0.000034072,0.000034211,0.000034164,0.000034278,0.000034183,0.000034099,0.000034563,0.000035799,0.000036767,0.000038367,0.000040444,0.000037722,0.000040465,0.000057027,0.000061721},
					    {0.000060463,0.000056096,0.000039803,0.000038225,0.000040002,0.000038337,0.000036846,0.000036101,0.000034873,0.000034342,0.000035183,0.000034819,0.000034766,0.000035417,0.000034481,0.000035100,0.000036327,0.000037931,0.000039044,0.000040779,0.000038282,0.000040100,0.000056507,0.000061729},
					    {0.000061550,0.000056852,0.000039882,0.000038175,0.000040346,0.000038008,0.000036904,0.000036202,0.000034812,0.000034442,0.000035482,0.000035102,0.000034783,0.000035086,0.000034194,0.000034599,0.000036209,0.000037218,0.000038825,0.000040999,0.000038595,0.000040122,0.000057332,0.000062027},
					    {0.000060459,0.000058419,0.000040372,0.000039966,0.000040264,0.000037964,0.000036740,0.000036262,0.000034710,0.000034220,0.000035085,0.000034882,0.000034664,0.000035103,0.000034195,0.000034783,0.000036147,0.000037196,0.000039351,0.000042328,0.000038204,0.000040165,0.000056800,0.000060727},
					    {0.000065362,0.000060000,0.000041122,0.000041637,0.000039771,0.000037614,0.000036339,0.000035644,0.000034367,0.000034043,0.000034903,0.000034279,0.000034213,0.000034571,0.000033670,0.000034356,0.000035251,0.000036567,0.000037722,0.000039973,0.000037742,0.000040089,0.000057150,0.000061181},
					    {0.000060991,0.000057910,0.000040448,0.000041135,0.000039886,0.000037824,0.000036408,0.000035681,0.000034322,0.000033872,0.000034357,0.000034310,0.000034306,0.000034409,0.000033598,0.000034243,0.000035395,0.000036264,0.000037627,0.000039674,0.000037241,0.000039975,0.000056184,0.000060487},
					    {0.000059026,0.000055909,0.000039875,0.000037953,0.000040124,0.000038222,0.000037004,0.000036403,0.000034737,0.000034166,0.000034908,0.000035067,0.000035107,0.000034792,0.000034413,0.000034631,0.000036700,0.000037228,0.000038790,0.000041669,0.000037830,0.000039791,0.000055796,0.000059544},
					    {0.000064642,0.000061471,0.000042957,0.000045055,0.000041527,0.000038594,0.000037291,0.000036587,0.000034856,0.000034819,0.000035220,0.000035326,0.000035299,0.000035395,0.000034557,0.000034803,0.000036285,0.000037131,0.000038676,0.000040751,0.000043258,0.000042808,0.000062417,0.000070403},
					    {0.000060631,0.000056970,0.000040709,0.000039186,0.000040832,0.000038729,0.000037213,0.000035965,0.000034438,0.000033904,0.000035109,0.000034068,0.000034196,0.000034011,0.000033621,0.000034135,0.000035311,0.000036454,0.000037831,0.000039646,0.000037789,0.000040271,0.000056461,0.000062897},
					    {0.000059829,0.000055507,0.000039969,0.000038032,0.000040095,0.000038102,0.000037223,0.000035625,0.000034258,0.000034052,0.000041084,0.000034276,0.000034535,0.000035148,0.000034538,0.000034384,0.000035504,0.000036815,0.000037843,0.000039832,0.000043763,0.000040813,0.000056885,0.000060375},
					    {0.000060184,0.000056317,0.000039854,0.000038195,0.000040267,0.000037668,0.000036565,0.000035997,0.000034210,0.000033847,0.000036289,0.000034441,0.000034522,0.000040962,0.000034121,0.000034637,0.000037096,0.000037314,0.000038266,0.000040292,0.000037360,0.000039853,0.000056667,0.000059981},
					    {0.000059492,0.000056402,0.000040535,0.000040071,0.000040189,0.000037847,0.000036869,0.000036192,0.000034531,0.000034053,0.000034982,0.000034550,0.000034530,0.000041158,0.000033951,0.000034520,0.000036060,0.000036848,0.000038136,0.000040270,0.000037808,0.000040158,0.000055864,0.000059492},
					    {0.000061104,0.000057358,0.000040890,0.000038996,0.000040335,0.000038078,0.000036853,0.000035747,0.000034565,0.000034065,0.000034273,0.000034213,0.000034235,0.000034263,0.000034066,0.000034415,0.000035450,0.000036594,0.000037728,0.000039857,0.000037246,0.000039804,0.000056578,0.000061689},
					    {0.000061366,0.000058216,0.000041266,0.000042250,0.000039850,0.000038020,0.000036814,0.000035558,0.000034496,0.000033769,0.000034482,0.000034143,0.000033998,0.000034090,0.000033569,0.000034059,0.000035124,0.000036425,0.000039139,0.000041851,0.000037563,0.000039547,0.000055867,0.000059660},
					    {0.000060381,0.000056167,0.000040455,0.000038522,0.000040254,0.000037956,0.000036789,0.000036220,0.000034695,0.000034501,0.000034977,0.000034809,0.000034780,0.000034867,0.000034205,0.000034813,0.000036597,0.000037149,0.000038634,0.000040810,0.000037938,0.000040022,0.000056018,0.000059865}};


const float rochcor2012::dcor_maer[16][24]={{0.000068153,0.000061059,0.000042379,0.000039876,0.000041060,0.000038680,0.000037244,0.000036566,0.000034915,0.000034630,0.000035163,0.000035047,0.000034797,0.000034949,0.000034482,0.000034995,0.000036782,0.000037567,0.000038937,0.000041177,0.000042827,0.000042102,0.000060168,0.000064936},
					    {0.000069548,0.000061729,0.000042743,0.000042676,0.000040073,0.000037608,0.000036606,0.000035547,0.000034354,0.000034072,0.000034211,0.000034164,0.000034278,0.000034183,0.000034099,0.000034563,0.000035799,0.000036767,0.000038367,0.000040444,0.000037722,0.000040465,0.000057027,0.000061721},
					    {0.000060463,0.000056096,0.000039803,0.000038225,0.000040002,0.000038337,0.000036846,0.000036101,0.000034873,0.000034342,0.000035183,0.000034819,0.000034766,0.000035417,0.000034481,0.000035100,0.000036327,0.000037931,0.000039044,0.000040779,0.000038282,0.000040100,0.000056507,0.000061729},
					    {0.000061550,0.000056852,0.000039882,0.000038175,0.000040346,0.000038008,0.000036904,0.000036202,0.000034812,0.000034442,0.000035482,0.000035102,0.000034783,0.000035086,0.000034194,0.000034599,0.000036209,0.000037218,0.000038825,0.000040999,0.000038595,0.000040122,0.000057332,0.000062027},
					    {0.000060459,0.000058419,0.000040372,0.000039966,0.000040264,0.000037964,0.000036740,0.000036262,0.000034710,0.000034220,0.000035085,0.000034882,0.000034664,0.000035103,0.000034195,0.000034783,0.000036147,0.000037196,0.000039351,0.000042328,0.000038204,0.000040165,0.000056800,0.000060727},
					    {0.000065362,0.000060000,0.000041122,0.000041637,0.000039771,0.000037614,0.000036339,0.000035644,0.000034367,0.000034043,0.000034903,0.000034279,0.000034213,0.000034571,0.000033670,0.000034356,0.000035251,0.000036567,0.000037722,0.000039973,0.000037742,0.000040089,0.000057150,0.000061181},
					    {0.000060991,0.000057910,0.000040448,0.000041135,0.000039886,0.000037824,0.000036408,0.000035681,0.000034322,0.000033872,0.000034357,0.000034310,0.000034306,0.000034409,0.000033598,0.000034243,0.000035395,0.000036264,0.000037627,0.000039674,0.000037241,0.000039975,0.000056184,0.000060487},
					    {0.000059026,0.000055909,0.000039875,0.000037953,0.000040124,0.000038222,0.000037004,0.000036403,0.000034737,0.000034166,0.000034908,0.000035067,0.000035107,0.000034792,0.000034413,0.000034631,0.000036700,0.000037228,0.000038790,0.000041669,0.000037830,0.000039791,0.000055796,0.000059544},
					    {0.000064642,0.000061471,0.000042957,0.000045055,0.000041527,0.000038594,0.000037291,0.000036587,0.000034856,0.000034819,0.000035220,0.000035326,0.000035299,0.000035395,0.000034557,0.000034803,0.000036285,0.000037131,0.000038676,0.000040751,0.000043258,0.000042808,0.000062417,0.000070403},
					    {0.000060631,0.000056970,0.000040709,0.000039186,0.000040832,0.000038729,0.000037213,0.000035965,0.000034438,0.000033904,0.000035109,0.000034068,0.000034196,0.000034011,0.000033621,0.000034135,0.000035311,0.000036454,0.000037831,0.000039646,0.000037789,0.000040271,0.000056461,0.000062897},
					    {0.000059829,0.000055507,0.000039969,0.000038032,0.000040095,0.000038102,0.000037223,0.000035625,0.000034258,0.000034052,0.000041084,0.000034276,0.000034535,0.000035148,0.000034538,0.000034384,0.000035504,0.000036815,0.000037843,0.000039832,0.000043763,0.000040813,0.000056885,0.000060375},
					    {0.000060184,0.000056317,0.000039854,0.000038195,0.000040267,0.000037668,0.000036565,0.000035997,0.000034210,0.000033847,0.000036289,0.000034441,0.000034522,0.000040962,0.000034121,0.000034637,0.000037096,0.000037314,0.000038266,0.000040292,0.000037360,0.000039853,0.000056667,0.000059981},
					    {0.000059492,0.000056402,0.000040535,0.000040071,0.000040189,0.000037847,0.000036869,0.000036192,0.000034531,0.000034053,0.000034982,0.000034550,0.000034530,0.000041158,0.000033951,0.000034520,0.000036060,0.000036848,0.000038136,0.000040270,0.000037808,0.000040158,0.000055864,0.000059492},
					    {0.000061104,0.000057358,0.000040890,0.000038996,0.000040335,0.000038078,0.000036853,0.000035747,0.000034565,0.000034065,0.000034273,0.000034213,0.000034235,0.000034263,0.000034066,0.000034415,0.000035450,0.000036594,0.000037728,0.000039857,0.000037246,0.000039804,0.000056578,0.000061689},
					    {0.000061366,0.000058216,0.000041266,0.000042250,0.000039850,0.000038020,0.000036814,0.000035558,0.000034496,0.000033769,0.000034482,0.000034143,0.000033998,0.000034090,0.000033569,0.000034059,0.000035124,0.000036425,0.000039139,0.000041851,0.000037563,0.000039547,0.000055867,0.000059660},
					    {0.000060381,0.000056167,0.000040455,0.000038522,0.000040254,0.000037956,0.000036789,0.000036220,0.000034695,0.000034501,0.000034977,0.000034809,0.000034780,0.000034867,0.000034205,0.000034813,0.000036597,0.000037149,0.000038634,0.000040810,0.000037938,0.000040022,0.000056018,0.000059865}};

const float rochcor2012::mcor_bfer[16][24]={{0.000057315,0.000053172,0.000037553,0.000035480,0.000036771,0.000035067,0.000034232,0.000033195,0.000032095,0.000031726,0.000032198,0.000031972,0.000031842,0.000032228,0.000031667,0.000032340,0.000033730,0.000034314,0.000035744,0.000037130,0.000037907,0.000037611,0.000053019,0.000055486},
					    {0.000059286,0.000054058,0.000037459,0.000037447,0.000036356,0.000034663,0.000033690,0.000032963,0.000032081,0.000031765,0.000031784,0.000031767,0.000031811,0.000031747,0.000031814,0.000032128,0.000033134,0.000034048,0.000035273,0.000036867,0.000034338,0.000036845,0.000051287,0.000054547},
					    {0.000053697,0.000050198,0.000036305,0.000034636,0.000036407,0.000035217,0.000034067,0.000033104,0.000032162,0.000031965,0.000032368,0.000032158,0.000032207,0.000032726,0.000032075,0.000032484,0.000033464,0.000034738,0.000035612,0.000036850,0.000034513,0.000036855,0.000051041,0.000054455},
					    {0.000053431,0.000050328,0.000036454,0.000034542,0.000036593,0.000034863,0.000033896,0.000033498,0.000032250,0.000031868,0.000032348,0.000032266,0.000032200,0.000032340,0.000031690,0.000032262,0.000033095,0.000034324,0.000035280,0.000036660,0.000034460,0.000036441,0.000050041,0.000053702},
					    {0.000053025,0.000051742,0.000036816,0.000036208,0.000036504,0.000035110,0.000033907,0.000033341,0.000032381,0.000031966,0.000032427,0.000032334,0.000032208,0.000032484,0.000031788,0.000032365,0.000033255,0.000034167,0.000035565,0.000037661,0.000034660,0.000036780,0.000050763,0.000053789},
					    {0.000054655,0.000052075,0.000036970,0.000037772,0.000036628,0.000034417,0.000033957,0.000032985,0.000032208,0.000031740,0.000032157,0.000031879,0.000031965,0.000032020,0.000031682,0.000032028,0.000032874,0.000034008,0.000034998,0.000036532,0.000034352,0.000036832,0.000051105,0.000053307},
					    {0.000053573,0.000051561,0.000036863,0.000037401,0.000036434,0.000034752,0.000033750,0.000032930,0.000032055,0.000031658,0.000031738,0.000031908,0.000031992,0.000031856,0.000031443,0.000031939,0.000032914,0.000033764,0.000034655,0.000036330,0.000034317,0.000036623,0.000050567,0.000053460},
					    {0.000052657,0.000050721,0.000036287,0.000034429,0.000036323,0.000034881,0.000033836,0.000033215,0.000032075,0.000031546,0.000032092,0.000032151,0.000032013,0.000031958,0.000031745,0.000031970,0.000033450,0.000034251,0.000035119,0.000037704,0.000034375,0.000036577,0.000050875,0.000053935},
					    {0.000055310,0.000052339,0.000037433,0.000037539,0.000037045,0.000035082,0.000034080,0.000032951,0.000032216,0.000031988,0.000032167,0.000032032,0.000032258,0.000032217,0.000031913,0.000032250,0.000033223,0.000033960,0.000035074,0.000036846,0.000038836,0.000037911,0.000053296,0.000060265},
					    {0.000054004,0.000051248,0.000036877,0.000034620,0.000037137,0.000035452,0.000034351,0.000033228,0.000032142,0.000031708,0.000032381,0.000031620,0.000031966,0.000031696,0.000031520,0.000031699,0.000032956,0.000033758,0.000034580,0.000036316,0.000034428,0.000036959,0.000051004,0.000056287},
					    {0.000053103,0.000050364,0.000036449,0.000034663,0.000036541,0.000034789,0.000033999,0.000032827,0.000032109,0.000031854,0.000036960,0.000031868,0.000032001,0.000031846,0.000031535,0.000032009,0.000032848,0.000033929,0.000034609,0.000036277,0.000039642,0.000037270,0.000051619,0.000054382},
					    {0.000052917,0.000050264,0.000036443,0.000034468,0.000036552,0.000034531,0.000033751,0.000032999,0.000031833,0.000031476,0.000033441,0.000031872,0.000032116,0.000036808,0.000031665,0.000031971,0.000033174,0.000033747,0.000034842,0.000036356,0.000033900,0.000036331,0.000050158,0.000052671},
					    {0.000053602,0.000050837,0.000036996,0.000036184,0.000036617,0.000034748,0.000033906,0.000033298,0.000032235,0.000031676,0.000032237,0.000032078,0.000032131,0.000036673,0.000031741,0.000032012,0.000033390,0.000034010,0.000034696,0.000036543,0.000034168,0.000036793,0.000050750,0.000053282},
					    {0.000054197,0.000051020,0.000036959,0.000035212,0.000036813,0.000034561,0.000033920,0.000032942,0.000032180,0.000031813,0.000031920,0.000031791,0.000031873,0.000031959,0.000031736,0.000032317,0.000033017,0.000033982,0.000034633,0.000036259,0.000033996,0.000036538,0.000050983,0.000054226},
					    {0.000053986,0.000051839,0.000037071,0.000038063,0.000036491,0.000034956,0.000034006,0.000032897,0.000032168,0.000031536,0.000032174,0.000031895,0.000031565,0.000031738,0.000031601,0.000031795,0.000032633,0.000033918,0.000036021,0.000038262,0.000034358,0.000036171,0.000050618,0.000052229},
					    {0.000053729,0.000050922,0.000036499,0.000034795,0.000036563,0.000035057,0.000033991,0.000033182,0.000032206,0.000031545,0.000032159,0.000031901,0.000031971,0.000032106,0.000031715,0.000032014,0.000033353,0.000034032,0.000035524,0.000037021,0.000034606,0.000036646,0.000051093,0.000052879}};


const float rochcor2012::mcor_maer[16][24]={{0.000057315,0.000053172,0.000037553,0.000035480,0.000036771,0.000035067,0.000034232,0.000033195,0.000032095,0.000031726,0.000032198,0.000031972,0.000031842,0.000032228,0.000031667,0.000032340,0.000033730,0.000034314,0.000035744,0.000037130,0.000037907,0.000037611,0.000053019,0.000055486},
					    {0.000059286,0.000054058,0.000037459,0.000037447,0.000036356,0.000034663,0.000033690,0.000032963,0.000032081,0.000031765,0.000031784,0.000031767,0.000031811,0.000031747,0.000031814,0.000032128,0.000033134,0.000034048,0.000035273,0.000036867,0.000034338,0.000036845,0.000051287,0.000054547},
					    {0.000053697,0.000050198,0.000036305,0.000034636,0.000036407,0.000035217,0.000034067,0.000033104,0.000032162,0.000031965,0.000032368,0.000032158,0.000032207,0.000032726,0.000032075,0.000032484,0.000033464,0.000034738,0.000035612,0.000036850,0.000034513,0.000036855,0.000051041,0.000054455},
					    {0.000053431,0.000050328,0.000036454,0.000034542,0.000036593,0.000034863,0.000033896,0.000033498,0.000032250,0.000031868,0.000032348,0.000032266,0.000032200,0.000032340,0.000031690,0.000032262,0.000033095,0.000034324,0.000035280,0.000036660,0.000034460,0.000036441,0.000050041,0.000053702},
					    {0.000053025,0.000051742,0.000036816,0.000036208,0.000036504,0.000035110,0.000033907,0.000033341,0.000032381,0.000031966,0.000032427,0.000032334,0.000032208,0.000032484,0.000031788,0.000032365,0.000033255,0.000034167,0.000035565,0.000037661,0.000034660,0.000036780,0.000050763,0.000053789},
					    {0.000054655,0.000052075,0.000036970,0.000037772,0.000036628,0.000034417,0.000033957,0.000032985,0.000032208,0.000031740,0.000032157,0.000031879,0.000031965,0.000032020,0.000031682,0.000032028,0.000032874,0.000034008,0.000034998,0.000036532,0.000034352,0.000036832,0.000051105,0.000053307},
					    {0.000053573,0.000051561,0.000036863,0.000037401,0.000036434,0.000034752,0.000033750,0.000032930,0.000032055,0.000031658,0.000031738,0.000031908,0.000031992,0.000031856,0.000031443,0.000031939,0.000032914,0.000033764,0.000034655,0.000036330,0.000034317,0.000036623,0.000050567,0.000053460},
					    {0.000052657,0.000050721,0.000036287,0.000034429,0.000036323,0.000034881,0.000033836,0.000033215,0.000032075,0.000031546,0.000032092,0.000032151,0.000032013,0.000031958,0.000031745,0.000031970,0.000033450,0.000034251,0.000035119,0.000037704,0.000034375,0.000036577,0.000050875,0.000053935},
					    {0.000055310,0.000052339,0.000037433,0.000037539,0.000037045,0.000035082,0.000034080,0.000032951,0.000032216,0.000031988,0.000032167,0.000032032,0.000032258,0.000032217,0.000031913,0.000032250,0.000033223,0.000033960,0.000035074,0.000036846,0.000038836,0.000037911,0.000053296,0.000060265},
					    {0.000054004,0.000051248,0.000036877,0.000034620,0.000037137,0.000035452,0.000034351,0.000033228,0.000032142,0.000031708,0.000032381,0.000031620,0.000031966,0.000031696,0.000031520,0.000031699,0.000032956,0.000033758,0.000034580,0.000036316,0.000034428,0.000036959,0.000051004,0.000056287},
					    {0.000053103,0.000050364,0.000036449,0.000034663,0.000036541,0.000034789,0.000033999,0.000032827,0.000032109,0.000031854,0.000036960,0.000031868,0.000032001,0.000031846,0.000031535,0.000032009,0.000032848,0.000033929,0.000034609,0.000036277,0.000039642,0.000037270,0.000051619,0.000054382},
					    {0.000052917,0.000050264,0.000036443,0.000034468,0.000036552,0.000034531,0.000033751,0.000032999,0.000031833,0.000031476,0.000033441,0.000031872,0.000032116,0.000036808,0.000031665,0.000031971,0.000033174,0.000033747,0.000034842,0.000036356,0.000033900,0.000036331,0.000050158,0.000052671},
					    {0.000053602,0.000050837,0.000036996,0.000036184,0.000036617,0.000034748,0.000033906,0.000033298,0.000032235,0.000031676,0.000032237,0.000032078,0.000032131,0.000036673,0.000031741,0.000032012,0.000033390,0.000034010,0.000034696,0.000036543,0.000034168,0.000036793,0.000050750,0.000053282},
					    {0.000054197,0.000051020,0.000036959,0.000035212,0.000036813,0.000034561,0.000033920,0.000032942,0.000032180,0.000031813,0.000031920,0.000031791,0.000031873,0.000031959,0.000031736,0.000032317,0.000033017,0.000033982,0.000034633,0.000036259,0.000033996,0.000036538,0.000050983,0.000054226},
					    {0.000053986,0.000051839,0.000037071,0.000038063,0.000036491,0.000034956,0.000034006,0.000032897,0.000032168,0.000031536,0.000032174,0.000031895,0.000031565,0.000031738,0.000031601,0.000031795,0.000032633,0.000033918,0.000036021,0.000038262,0.000034358,0.000036171,0.000050618,0.000052229},
					    {0.000053729,0.000050922,0.000036499,0.000034795,0.000036563,0.000035057,0.000033991,0.000033182,0.000032206,0.000031545,0.000032159,0.000031901,0.000031971,0.000032106,0.000031715,0.000032014,0.000033353,0.000034032,0.000035524,0.000037021,0.000034606,0.000036646,0.000051093,0.000052879}};

const float rochcor2012::sf[3] = {0.00490799,-0.000286228,0.00189369};
const float rochcor2012::sfer[3] = {0.000255664,0.000155131,0.000134043};


//===============================================================================================

rochcor2012::~rochcor2012(){
}

rochcor2012::rochcor2012(){
  
  eran.SetSeed(123456);
  sran.SetSeed(1234);
  
  gscler_mc_dev=0;
  gscler_da_dev=0;

  for(int i=0; i<16; ++i){
      for(int j=0; j<24; ++j){
          mptsys_mc_dm[i][j]=0;
          mptsys_mc_da[i][j]=0;
          mptsys_da_dm[i][j]=0;
          mptsys_da_da[i][j]=0;
      }
  }

}

rochcor2012::rochcor2012(int seed){
  eran.SetSeed(123456);
  sran.SetSeed(seed);

  gscler_mc_dev=sran.Gaus(0.0, 1.0);
  gscler_da_dev=sran.Gaus(0.0, 1.0);

  for(int i=0; i<16; ++i){
      for(int j=0; j<24; ++j){
          mptsys_mc_dm[i][j]=sran.Gaus(0.0, 1.0);
          mptsys_mc_da[i][j]=sran.Gaus(0.0, 1.0);
          mptsys_da_dm[i][j]=sran.Gaus(0.0, 1.0);
          mptsys_da_da[i][j]=sran.Gaus(0.0, 1.0);
      }
  }
}

void rochcor2012::momcor_mc( TLorentzVector& mu, float charge, int runopt, float& qter){
  
  //sysdev == num : deviation = num

  float ptmu = mu.Pt();
  float muphi = mu.Phi();
  float mueta = mu.Eta(); // same with mu.Eta() in Root

  float px = mu.Px();
  float py = mu.Py();
  float pz = mu.Pz();
  float e = mu.E();

  int mu_phibin = phibin(muphi);
  int mu_etabin = etabin(mueta);
  
  if(mu_phibin>=0 && mu_etabin>=0){
    
    float Mf = (mcor_bf[mu_phibin][mu_etabin] + mptsys_mc_dm[mu_phibin][mu_etabin]*mcor_bfer[mu_phibin][mu_etabin])/(mpavg[mu_phibin][mu_etabin]+mmavg[mu_phibin][mu_etabin]);
    float Af = ((mcor_ma[mu_phibin][mu_etabin]+mptsys_mc_da[mu_phibin][mu_etabin]*mcor_maer[mu_phibin][mu_etabin]) - Mf*(mpavg[mu_phibin][mu_etabin]-mmavg[mu_phibin][mu_etabin]));     
    
    float cor = 1.0/(1.0 + 2.0*Mf + charge*Af*ptmu);    
    
    //for the momentum tuning - eta,phi,Q correction
    px *= cor;
    py *= cor;
    pz *= cor;
    e  *= cor;
    
    float gscler = mgscl_stat;    
    float gscl = (genm_smr/mrecm);
    
    px *= (gscl + gscler_mc_dev*gscler);
    py *= (gscl + gscler_mc_dev*gscler);
    pz *= (gscl + gscler_mc_dev*gscler);
    e  *= (gscl + gscler_mc_dev*gscler);
    
    float momscl = sqrt(px*px + py*py)/ptmu;
    
    float exsm = sf[0] + sf[1]*mueta + sf[2]*mueta*mueta;
    float tune = 1.0/eran.Gaus(1.0,exsm);
    
    px *= (tune); 
    py *= (tune);  
    pz *= (tune);  
    e  *= (tune);   
    
    qter *= sqrt(momscl*momscl + (1.0-tune)*(1.0-tune));
  }
  
  mu.SetPxPyPzE(px,py,pz,e);
  
}


void rochcor2012::momcor_data( TLorentzVector& mu, float charge, int runopt, float& qter){
  
  float ptmu = mu.Pt();

  float muphi = mu.Phi();
  float mueta = mu.Eta(); // same with mu.Eta() in Root

  float px = mu.Px();
  float py = mu.Py();
  float pz = mu.Pz();
  float e = mu.E();
  
  int mu_phibin = phibin(muphi);
  int mu_etabin = etabin(mueta);
  
  if(mu_phibin>=0 && mu_etabin>=0){
    
    float Mf = (dcor_bf[mu_phibin][mu_etabin]+mptsys_da_dm[mu_phibin][mu_etabin]*dcor_bfer[mu_phibin][mu_etabin])/(dpavg[mu_phibin][mu_etabin]+dmavg[mu_phibin][mu_etabin]);
    float Af = ((dcor_ma[mu_phibin][mu_etabin]+mptsys_da_da[mu_phibin][mu_etabin]*dcor_maer[mu_phibin][mu_etabin]) - Mf*(dpavg[mu_phibin][mu_etabin]-dmavg[mu_phibin][mu_etabin]));     
    
    float cor = 1.0/(1.0 + 2.0*Mf + charge*Af*ptmu);
    
    px *= cor;
    py *= cor;
    pz *= cor;
    e  *= cor;
    
    //after Z pt correction
    float gscler = dgscl_stat;
    float gscl = (genm_smr/drecm);
    
    px *= (gscl + gscler_da_dev*gscler);
    py *= (gscl + gscler_da_dev*gscler);
    pz *= (gscl + gscler_da_dev*gscler);
    e  *= (gscl + gscler_da_dev*gscler);
    
    float momscl = sqrt(px*px + py*py)/ptmu;
    qter *= momscl;
    
  }
  
  mu.SetPxPyPzE(px,py,pz,e);
  
}

Int_t rochcor2012::phibin(float phi){
  
  int nphibin = -1;
  
  for(int i=0; i<16; i++){
    if(-pi+(2.0*pi/16.0)*i <= phi && -pi+(2.0*pi/16.0)*(i+1) > phi){
      nphibin = i;
      break;
    }
  }
  
  return nphibin;
}

Int_t rochcor2012::etabin(float eta){
  
  int nbin = -1;
  
  for(int i=0; i<24; i++){
    if(netabin[i] <= eta && netabin[i+1] > eta){
      nbin = i;
      break;
    }
  }
  
  return nbin;
}

